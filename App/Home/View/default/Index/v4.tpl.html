{{include file="Public:header" /}}
<style>
html {
    -webkit-font-smoothing: antialiased; /* 1 */
    -webkit-text-size-adjust: 100%; /* 2 */
}
.ui-slider-content {float:left;}
.ui-slider-content span {background-size:cover;}
.ui-slider {}
</style>
<script src="__PUBLIC__/Home/js/index.js" type="text/javascript"></script>
    <body ontouchstart style="visibility:hidden;background-color:#F0FDD4;width:100%;">
    <div class="ui-slider" style="width:100%;" onclick="window.location.reload()">
    <?php
        $_slideArr = array(
                "banner_1.jpg","banner_2.jpg","banner_3.jpg"
            );
    ?>
        <ul class="ui-slider-content" style="width:100%;">
            {{volist name="_slideArr" id="r"}}
            <li style="width:100%;"><span 
                style="background-image:url(__PUBLIC__/Home/img/{{$r}});height:auto;
                background-size:cover;background-position:center center;overflow:hidden;"
                ><img src="__PUBLIC__/Home/img/50_16.png?r=1"
                 width="100%;" style="float:left;"></span></li>
            {{/volist}}
        </ul>
    </div>
    <section class="rotate-module"> 
        <dl class="rotate-module-in">    
            <dt class="rotate-img"><img draggable="false"
             src="__PUBLIC__/Home/img/rotate_module.png" /></dt> 
            
            <dd id="rotate-blk" class="rotate-blk">
                <div class="link-i-com abs-rotate"><a 
                    href="{{:U('/Page/index/key/company')}}">&nbsp;</a></div>
                <div class="link-i-store abs-rotate"><a href="{{:U('/Merchants')}}">&nbsp;</a></div>
                <div class="link-i-product abs-rotate"><a 
                    href="{{:U('/Page/index/key/product')}}">&nbsp;</a></div>
                <div class="link-i-contact abs-rotate"><a 
                    href="{{:U('/Page/index/key/contact')}}">&nbsp;</a></div>
                <div class="link-i-help abs-rotate"><a href="{{:U('/Page/index/key/help')}}">&nbsp;</a></div>
                <div class="link-i-article abs-rotate"><a href="{{:U('/Article')}}">&nbsp;</a></div>
                <div class="link-i-form abs-rotate"><a href="{{:U('/Cylinder')}}">&nbsp;</a></div>
            </dd>
            <dd class="rotate-id-img"><img src="__PUBLIC__/Home/img/rotate_warp.png"
            width="100%" id="rotate-img" /></dd>
        </dl>
    </section><!-- /.ui-container-->
    

{{include file="Public:footer" /}}
<script src="__STATIC__/jquery/touch.js"></script>
<script>
$(function(){
    
    setTimeout(function(){
        $("body").css({"visibility":"visible"});
        $("#rotate-img").css({"webkitTransition":"All 0.4s ease-in-out"});
    },300)
    

    var angle = 0,startY,startX,startRot = true;
    touch.on('#rotate-img', 'touchstart', function(ev){
        ev.startRotate();
        ev.preventDefault();
        startY = ev.targetTouches[0].pageY;
        startX = ev.targetTouches[0].pageX;
    });
    touch.on('#rotate-img','touchend',function(ev){
        if ((Math.abs(ev.changedTouches[0].pageY - startY) < 5)&&
            (Math.abs(ev.changedTouches[0].pageX - startX) < 5)) {
            $.each($(".abs-rotate a"),function(i,n){
                var _h = parseFloat($(n).height()),_w = parseFloat($(n).width()),
                _x = $(n).offset().left,_y = $(n).offset().top;
                var _py = ev.changedTouches[0].pageY,_px = ev.changedTouches[0].pageX;
                //console.log("h:"+_h + "w:"+_w + "x:"+_x + "y:"+_y + "py:"+_py + "px:"+_px)
                if(_x <= _px && (_x + _w) > _px && _y <= _py && (_y + _h) > _py){
                    if($(n).parent().hasClass("link-i-form")){
                        $(".rotate-img").addClass("click_down");
                        
                        setTimeout(function(){
                            $(".rotate-img").removeClass("click_down");
                            window.location.href = $(n).attr("href");
                        },500);
                    }else{
                        window.location.href = $(n).attr("href");
                    }
                }
            })
            setTimeout(function(){ev.target.click();},100)
        }else{
            $(".rotate-blk").css({"z-index":0});
        }
    })

    touch.on('#rotate-img', 'rotate', function(ev){
        _rotate = Math.abs(ev.rotation);
        _rotate = _rotate > 360?_rotate:_rotate*2;
        console.log(ev.rotation + "_rotate:" + _rotate)
        if(ev.direction === 'left'){
            _rotate = -_rotate;
        }
        var totalAngle = angle + _rotate;
        if(ev.fingerStatus === 'end'){
            angle = totalAngle;
        }
        var _rotateObj = document.getElementById("rotate-img");
        var _rotateBlk = document.getElementById("rotate-blk");
        //$("#rotate-blk-2").css({"webkitTransform":"rotate(" + totalAngle  + "deg)"});
        _rotateObj.style.webkitTransform = 'rotate(' + totalAngle + 'deg)';
        _rotateBlk.style.webkitTransform = 'rotate(' + totalAngle + 'deg)';
        //this.style.webkitTransform = 'rotate(' + totalAngle + 'deg)';
    });

})

</script>   




